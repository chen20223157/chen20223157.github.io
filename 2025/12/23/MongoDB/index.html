<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>MongoDB | 欢迎来到chen的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="MongoDB 是目前最流行的文档型 NoSQL 数据库，因灵活的 schema、高扩展性和适用于非结构化 &#x2F; 半结构化数据场景而被广泛使用。以下是关于 MongoDB 的核心知识点及常见面试题： 一、基础概念与特性 什么是 MongoDB？它的核心特性是什么？  定义：MongoDB 是一个开源的文档型 NoSQL 数据库，数据以类似 JSON 的 “文档”（BSON 格式）存储，无需">
<meta property="og:type" content="article">
<meta property="og:title" content="MongoDB">
<meta property="og:url" content="http://example.com/2025/12/23/MongoDB/index.html">
<meta property="og:site_name" content="欢迎来到chen的博客">
<meta property="og:description" content="MongoDB 是目前最流行的文档型 NoSQL 数据库，因灵活的 schema、高扩展性和适用于非结构化 &#x2F; 半结构化数据场景而被广泛使用。以下是关于 MongoDB 的核心知识点及常见面试题： 一、基础概念与特性 什么是 MongoDB？它的核心特性是什么？  定义：MongoDB 是一个开源的文档型 NoSQL 数据库，数据以类似 JSON 的 “文档”（BSON 格式）存储，无需">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-12-23T11:29:50.000Z">
<meta property="article:modified_time" content="2025-12-24T03:04:21.768Z">
<meta property="article:author" content="little chen">
<meta property="article:tag" content="测试开发,后端开发，测试">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="欢迎来到chen的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">欢迎来到chen的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">一个专注于技术分享的博客，详情可访问我的csdn——&gt;id:weixin_73527660</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-MongoDB" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/12/23/MongoDB/" class="article-date">
  <time class="dt-published" datetime="2025-12-23T11:29:50.000Z" itemprop="datePublished">2025-12-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      MongoDB
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>MongoDB 是目前最流行的文档型 NoSQL 数据库，因灵活的 schema、高扩展性和适用于非结构化 &#x2F; 半结构化数据场景而被广泛使用。以下是关于 MongoDB 的核心知识点及常见面试题：</p>
<h3 id="一、基础概念与特性"><a href="#一、基础概念与特性" class="headerlink" title="一、基础概念与特性"></a>一、基础概念与特性</h3><ol>
<li><p><strong>什么是 MongoDB？它的核心特性是什么？</strong></p>
<ul>
<li>定义：MongoDB 是一个开源的<strong>文档型 NoSQL 数据库</strong>，数据以类似 JSON 的 “文档”（BSON 格式）存储，无需预定义 schema（表结构），适合存储非结构化或半结构化数据。</li>
<li>核心特性：     <ul>
<li><strong>文档模型</strong>：数据以键值对形式的文档（BSON）存储，支持嵌套结构（如嵌入子文档、数组），更贴近业务对象（如用户文档可直接包含地址、订单列表）。</li>
<li><strong>无 schema 设计</strong>：同一集合（Collection）中的文档可拥有不同字段和结构，适合快速迭代的业务（如电商商品属性多变场景）。</li>
<li><strong>高可扩展性</strong>：支持副本集（高可用）和分片（水平扩展），轻松应对海量数据和高并发。</li>
<li><strong>丰富的查询能力</strong>：支持复杂查询（如范围查询、正则匹配）、聚合管道（数据分析）、地理空间查询等。</li>
<li><strong>索引支持</strong>：类似关系型数据库，支持单字段、复合、地理空间等多种索引，提升查询效率。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>MongoDB 与关系型数据库（如 MySQL）的核心区别是什么？</strong></p>
<table>
<thead>
<tr>
<th>维度</th>
<th>MongoDB（文档型）</th>
<th>关系型数据库（如 MySQL）</th>
</tr>
</thead>
<tbody><tr>
<td>数据模型</td>
<td>文档（BSON），支持嵌套和数组</td>
<td>二维表（行 + 列），需预定义表结构</td>
</tr>
<tr>
<td>Schema</td>
<td>动态 schema（同一集合文档结构可不同）</td>
<td>固定 schema（表结构需提前定义，修改成本高）</td>
</tr>
<tr>
<td>关联关系</td>
<td>推荐通过 “嵌入文档” 减少关联，也支持引用（$lookup）</td>
<td>通过外键强关联（JOIN 操作）</td>
</tr>
<tr>
<td>事务支持</td>
<td>4.0+ 支持多文档事务（有限制）</td>
<td>完整 ACID 事务支持</td>
</tr>
<tr>
<td>适用场景</td>
<td>非结构化数据（日志、用户画像）、快速迭代业务</td>
<td>结构化数据（订单、财务）、强事务场景</td>
</tr>
</tbody></table>
</li>
<li><p><strong>MongoDB 中的 “文档（Document）”“集合（Collection）”“数据库（Database）” 分别对应关系型数据库的什么概念？</strong></p>
<ul>
<li><p>文档（Document）</p>
<p>：类似关系型数据库的 “行（Row）”，但结构更灵活（可嵌套），以 BSON（二进制 JSON）格式存储（支持更多数据类型，如日期、ObjectId）。例：一个用户文档         </p>
<p>json</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;_id&quot;: ObjectId(&quot;650a1b3d7f82e1234567890&quot;),  // 自动生成的唯一标识</span><br><span class="line">  &quot;name&quot;: &quot;张三&quot;,</span><br><span class="line">  &quot;age&quot;: 25,</span><br><span class="line">  &quot;address&quot;: &#123; &quot;city&quot;: &quot;北京&quot;, &quot;street&quot;: &quot;XX路&quot; &#125;,  // 嵌入子文档</span><br><span class="line">  &quot;hobbies&quot;: [&quot;篮球&quot;, &quot;游戏&quot;]  // 数组</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</li>
<li><p><strong>集合（Collection）</strong>：类似关系型数据库的 “表（Table）”，是文档的集合，但集合中文档的结构可以不同（无 schema 约束）。</p>
</li>
<li><p><strong>数据库（Database）</strong>：类似关系型数据库的 “数据库”，是集合的容器，一个 MongoDB 实例可包含多个数据库（如 <code>user_db</code>、<code>order_db</code>）。</p>
</li>
</ul>
</li>
<li><p><strong>MongoDB 中的 <code>_id</code> 字段有什么作用？</strong></p>
<ul>
<li><code>_id</code> 是文档的<strong>唯一标识</strong>，类似关系型数据库的主键（Primary Key），每个文档必须包含 <code>_id</code> 字段（若未手动指定，MongoDB 会自动生成）。</li>
<li>自动生成的 <code>_id</code> 为 <code>ObjectId</code> 类型（12 字节），包含时间戳、机器 ID、进程 ID、自增计数器，确保分布式环境下的唯一性。</li>
<li>可手动指定 <code>_id</code>（如用业务 ID 作为 <code>_id</code>），但需保证唯一性，否则插入会报错（<code>duplicate key error</code>）。</li>
</ul>
</li>
</ol>
<h3 id="二、数据类型与核心操作"><a href="#二、数据类型与核心操作" class="headerlink" title="二、数据类型与核心操作"></a>二、数据类型与核心操作</h3><ol>
<li><p>**MongoDB 支持哪些特殊数据类型？**除了常见的字符串（String）、数字（Int&#x2F;Double）、布尔（Boolean），还支持：</p>
<ul>
<li><code>ObjectId</code>：用于 <code>_id</code> 字段，确保文档唯一性。</li>
<li><code>Date</code>：日期时间（精确到毫秒），如 <code>ISODate(&quot;2023-09-20T08:00:00Z&quot;)</code>。</li>
<li><code>Array</code>：数组，可包含多个值（如 <code>[1, 2, 3]</code> 或 <code>[&quot;a&quot;, {b:1}]</code>）。</li>
<li><code>Embedded Document</code>：嵌入子文档（如 <code>{address: {city: &quot;上海&quot;}}</code>）。</li>
<li><code>Binary Data</code>：二进制数据（如图片、文件）。</li>
<li><code>Regular Expression</code>：正则表达式（用于模糊查询）。</li>
</ul>
</li>
<li><p><strong>MongoDB 的 CRUD 操作常用命令是什么？</strong></p>
<ul>
<li><p><strong>创建（Create）</strong>：<code>insertOne()</code>（单文档）、<code>insertMany()</code>（多文档）</p>
<p>javascript</p>
<p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.users.insertOne(&#123; name: &quot;李四&quot;, age: 30 &#125;)  // 插入单条</span><br><span class="line">db.users.insertMany([&#123; name: &quot;王五&quot; &#125;, &#123; name: &quot;赵六&quot; &#125;])  // 插入多条</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</li>
<li><p><strong>查询（Read）</strong>：<code>find()</code>（查询所有）、<code>findOne()</code>（查询单条），支持条件筛选（<code>query</code>）和投影（<code>projection</code>）</p>
<p>javascript</p>
<p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 查询年龄&gt;25的用户，只返回name和age字段（_id默认返回，需显式排除）</span><br><span class="line">db.users.find(&#123; age: &#123; $gt: 25 &#125; &#125;, &#123; name: 1, age: 1, _id: 0 &#125;)</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</li>
<li><p><strong>更新（Update）</strong>：<code>updateOne()</code>（更新匹配的第一条）、<code>updateMany()</code>（更新所有匹配），需用更新操作符（<code>$set</code>、<code>$inc</code> 等）</p>
<p>javascript</p>
<p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 将name=李四的用户年龄+1</span><br><span class="line">db.users.updateOne(&#123; name: &quot;李四&quot; &#125;, &#123; $inc: &#123; age: 1 &#125; &#125;)</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</li>
<li><p><strong>删除（Delete）</strong>：<code>deleteOne()</code>（删除匹配的第一条）、<code>deleteMany()</code>（删除所有匹配）</p>
<p>javascript</p>
<p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 删除年龄&lt;18的用户</span><br><span class="line">db.users.deleteMany(&#123; age: &#123; $lt: 18 &#125; &#125;)</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</li>
</ul>
</li>
<li><p><strong>MongoDB 常用的查询操作符有哪些？</strong></p>
<ul>
<li>比较操作符：<code>$eq</code>（等于）、<code>$gt</code>（大于）、<code>$lt</code>（小于）、<code>$gte</code>（大于等于）、<code>$lte</code>（小于等于）、<code>$ne</code>（不等于）、<code>$in</code>（在数组中）、<code>$nin</code>（不在数组中）。例：<code>db.users.find({ age: { $gte: 18, $lte: 30 } })</code>（查询 18-30 岁用户）。</li>
<li>逻辑操作符：<code>$and</code>、<code>$or</code>、<code>$not</code>。例：<code>db.users.find({ $or: [{ age: { $gt: 30 } }, { name: &quot;张三&quot; }] })</code>。</li>
<li>数组操作符：<code>$in</code>（数组包含任一元素）、<code>$all</code>（数组包含所有元素）、<code>$size</code>（数组长度）。例：<code>db.users.find({ hobbies: { $all: [&quot;篮球&quot;, &quot;游戏&quot;] } })</code>（爱好同时包含篮球和游戏）。</li>
<li>嵌入文档操作符：<code>$</code>（匹配数组中的元素）、<code>$elemMatch</code>（数组元素多条件匹配）。</li>
</ul>
</li>
<li><p><strong>什么是 MongoDB 聚合管道（Aggregation Pipeline）？举例说明其用途。</strong></p>
<ul>
<li><p>聚合管道是 MongoDB 用于<strong>复杂数据处理和分析</strong>的工具，由多个 “阶段（Stage）” 组成，文档按顺序经过每个阶段处理，最终输出结果（类似流水线）。</p>
</li>
<li><p>常用阶段：</p>
<ul>
<li><code>$match</code>：筛选文档（类似 <code>find</code> 的查询条件）。</li>
<li><code>$group</code>：按字段分组，结合聚合函数（<code>$sum</code>、<code>$avg</code> 等）。</li>
<li><code>$project</code>：修改文档结构（保留 &#x2F; 排除字段、重命名）。</li>
<li><code>$sort</code>：排序。</li>
<li><code>$limit</code>：限制返回数量。</li>
</ul>
</li>
<li><p>示例：统计每个城市的用户数量，并按数量降序排列</p>
<p>javascript</p>
<p>运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">db.users.aggregate([</span><br><span class="line">  &#123; $match: &#123; age: &#123; $gte: 18 &#125; &#125; &#125;,  // 先筛选成年用户</span><br><span class="line">  &#123; $group: &#123; _id: &quot;$address.city&quot;, count: &#123; $sum: 1 &#125; &#125; &#125;,  // 按城市分组计数</span><br><span class="line">  &#123; $sort: &#123; count: -1 &#125; &#125;,  // 按数量降序</span><br><span class="line">  &#123; $limit: 10 &#125;  // 取前10</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
</li>
</ul>
</li>
</ol>
<h3 id="三、索引与性能优化"><a href="#三、索引与性能优化" class="headerlink" title="三、索引与性能优化"></a>三、索引与性能优化</h3><ol>
<li>**MongoDB 支持哪些类型的索引？**索引用于加速查询，避免全集合扫描（类似关系型数据库），常见类型：<ul>
<li><strong>单字段索引</strong>：对单个字段创建索引，如 <code>db.users.createIndex({ name: 1 })</code>（1 为升序，-1 为降序）。</li>
<li><strong>复合索引</strong>：对多个字段创建索引，遵循 “最左前缀原则”，如 <code>db.users.createIndex({ age: 1, name: -1 })</code>（查询 <code>age</code> 或 <code>age+name</code> 可命中，单独查 <code>name</code> 不命中）。</li>
<li><strong>地理空间索引</strong>：用于地理位置查询（如附近的人），如 <code>db.shops.createIndex({ location: &quot;2dsphere&quot; })</code>。</li>
<li><strong>文本索引</strong>：用于全文搜索，如 <code>db.articles.createIndex({ content: &quot;text&quot; })</code>，支持 <code>$text</code> 查询。</li>
<li><strong>哈希索引</strong>：对字段哈希值创建索引，适合等值查询，不支持范围查询。</li>
</ul>
</li>
<li><strong>如何查看索引是否被查询使用？如何优化索引？</strong><ul>
<li>用 <code>explain()</code> 分析查询执行计划，重点看 <code>executionStats.executionStages</code> 中的 <code>stage</code> 字段：<ul>
<li><code>IXSCAN</code>：索引扫描（命中索引，高效）；</li>
<li><code>COLLSCAN</code>：全集合扫描（未命中索引，需优化）。例：<code>db.users.find({ age: { $gt: 25 } }).explain(&quot;executionStats&quot;)</code>。</li>
</ul>
</li>
<li>索引优化原则：<ul>
<li>只为高频查询字段创建索引（索引会增加写入 &#x2F; 更新开销）。</li>
<li>复合索引字段顺序：将过滤性强的字段放前面（如性别字段过滤性差，不适合放前面）。</li>
<li>避免过度索引（一个集合索引建议不超过 5-10 个）。</li>
<li>删除未使用的索引（用 <code>db.collection.getIndexes()</code> 查看所有索引，结合监控判断是否有用）。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="四、高可用与分布式"><a href="#四、高可用与分布式" class="headerlink" title="四、高可用与分布式"></a>四、高可用与分布式</h3><ol>
<li><strong>什么是 MongoDB 副本集（Replica Set）？它的作用是什么？</strong><ul>
<li>副本集是 MongoDB 实现<strong>高可用</strong>的核心机制，由多个 MongoDB 实例组成（通常 3 个节点），包含：<ul>
<li><strong>Primary（主节点）</strong>：唯一可接收写操作的节点，负责将数据同步到从节点。</li>
<li><strong>Secondary（从节点）</strong>：从主节点复制数据，仅处理读操作（可通过 <code>readPreference</code> 配置读策略）。</li>
<li><strong>Arbiter（仲裁节点）</strong>：不存储数据，仅在主节点故障时参与投票选举新主节点（减少资源占用）。</li>
</ul>
</li>
<li>作用：<ul>
<li><strong>故障转移</strong>：主节点宕机后，副本集会自动选举新主节点（通过 Raft 算法），确保服务不中断。</li>
<li><strong>读写分离</strong>：读操作可分流到从节点，减轻主节点压力。</li>
<li><strong>数据冗余</strong>：数据多副本存储，避免单点故障导致数据丢失。</li>
</ul>
</li>
</ul>
</li>
<li><strong>副本集的故障转移过程是怎样的？</strong><ul>
<li><ol>
<li><strong>检测故障</strong>：从节点定期向主节点发送心跳（默认每 2 秒），若超过 <code>electionTimeoutMillis</code>（默认 10 秒）未收到响应，判定主节点不可用。</li>
</ol>
</li>
<li><ol>
<li><strong>发起选举</strong>：一个从节点（优先级高的优先）发起选举，向其他节点请求投票。</li>
</ol>
</li>
<li><ol>
<li><strong>选举新主节点</strong>：获得多数节点（超过半数）投票的从节点成为新主节点（如 3 节点副本集需至少 2 票）。</li>
</ol>
</li>
<li><ol>
<li><strong>同步数据</strong>：新主节点接收写操作，其他从节点从新主节点同步数据，恢复正常服务。</li>
</ol>
</li>
</ul>
</li>
<li><strong>什么是 MongoDB 分片（Sharding）？为什么需要分片？</strong><ul>
<li>分片是 MongoDB 应对<strong>海量数据</strong>的水平扩展方案，将大集合的数据拆分到多个 “分片（Shard）”（每个分片是一个副本集），实现数据分布式存储。</li>
<li>为什么需要分片？<ul>
<li>单节点存储容量有限（如磁盘空间不足）；</li>
<li>单节点读写压力过大（无法通过副本集分担，因副本集数据全量复制）。</li>
</ul>
</li>
<li>分片集群的核心组件：<ul>
<li><strong>Shard（分片）</strong>：存储实际数据（每个分片是副本集，保证高可用）。</li>
<li><strong>Mongos（路由节点）</strong>：接收客户端请求，根据分片键将请求路由到对应的分片（客户端只连接 Mongos）。</li>
<li><strong>Config Server（配置服务器）</strong>：存储集群元数据（如分片键范围、分片映射关系），通常为 3 节点副本集。</li>
</ul>
</li>
</ul>
</li>
<li><strong>分片键（Shard Key）的作用是什么？选择分片键需注意什么？</strong><ul>
<li>分片键是用于将集合数据拆分到不同分片的字段（如 <code>user_id</code>、<code>create_time</code>），MongoDB 通过分片键的值范围或哈希值决定数据存储的分片。</li>
<li>选择原则：<ul>
<li><strong>均衡性</strong>：分片键需使数据均匀分布到所有分片（避免某分片数据过多，成为瓶颈）。反例：用性别（男 &#x2F; 女）作为分片键，仅能拆分到 2 个分片，无法扩展。</li>
<li><strong>查询效率</strong>：分片键需与高频查询字段匹配（避免 Mongos 向所有分片广播查询）。</li>
<li><strong>不可变</strong>：分片键一旦设置，字段值不可修改（否则数据无法正确路由）。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="五、事务与数据一致性"><a href="#五、事务与数据一致性" class="headerlink" title="五、事务与数据一致性"></a>五、事务与数据一致性</h3><ol>
<li><strong>MongoDB 支持事务吗？有什么限制？</strong><ul>
<li>支持：MongoDB 4.0 开始支持<strong>多文档事务</strong>（单文档事务天然支持），4.2 后支持分片集群中的事务。</li>
<li>特性：满足 ACID 特性（原子性、一致性、隔离性、持久性），类似关系型数据库事务。</li>
<li>限制：     <ul>
<li>事务中的写操作会加锁，可能影响性能（建议事务执行时间短）。</li>
<li>分片集群中，事务涉及的文档需在同一个分片（通过分片键保证），否则事务失败。</li>
<li>不支持跨数据库的事务（4.2+ 支持同一部署下的跨库事务）。</li>
</ul>
</li>
</ul>
</li>
<li><strong>如何保证 MongoDB 数据的一致性？</strong><ul>
<li>副本集同步：主节点写入后，数据通过 oplog（操作日志）同步到从节点，确保从节点数据最终一致（默认异步同步，可配置 “多数确认” 保证强一致性）。</li>
<li>事务：多文档操作通过事务保证原子性（要么全成功，要么全失败）。</li>
<li>读写策略：     <ul>
<li>写操作：通过 <code>writeConcern</code> 配置（如 <code>{ w: &quot;majority&quot; }</code> 表示等待多数节点确认后返回，确保数据不丢失）。</li>
<li>读操作：通过 <code>readPreference</code> 配置（如 <code>primary</code> 只从主节点读，保证最新；<code>secondaryPreferred</code> 优先从从节点读，提升性能）。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="六、适用场景与局限性"><a href="#六、适用场景与局限性" class="headerlink" title="六、适用场景与局限性"></a>六、适用场景与局限性</h3><ol>
<li>MongoDB 适合哪些场景？不适合哪些场景？<ul>
<li><strong>适合场景</strong>：<ul>
<li>非结构化 &#x2F; 半结构化数据（如日志、用户画像、JSON 格式数据）；</li>
<li>快速迭代的业务（无需频繁修改 schema）；</li>
<li>高写入吞吐量场景（如物联网设备数据上报）；</li>
<li>地理空间查询（如 LBS 应用：附近的商家）；</li>
<li>大数据量存储（通过分片扩展）。</li>
</ul>
</li>
<li><strong>不适合场景</strong>：<ul>
<li>强事务需求（如金融交易，虽支持事务，但关系型数据库更成熟）；</li>
<li>复杂多表关联查询（MongoDB 的 <code>$lookup</code> 性能不如关系型数据库的 JOIN）；</li>
<li>数据一致性要求极高（如库存管理，需频繁锁操作）。</li>
</ul>
</li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/12/23/MongoDB/" data-id="cuidygaoOaUm9V8gMl_Fwecuf" data-title="MongoDB" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/12/23/Redis/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          Redis
        
      </div>
    </a>
  
  
    <a href="/2025/12/23/%E5%AE%9E%E6%B5%8B-ChatGPT-Code-%E6%96%B0%E6%80%A7%E8%83%BD%EF%BC%9A%E4%BB%8E%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%88%B0%E9%A1%B9%E7%9B%AE%E8%90%BD%E5%9C%B0%EF%BC%8CAI-%E7%BC%96%E7%A8%8B%E7%9A%84%E7%94%9F%E4%BA%A7%E5%8A%9B%E9%9D%A9%E5%91%BD%E5%B7%B2%E6%9D%A5/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">实测 ChatGPT-Code 新性能：从代码生成到项目落地，AI 编程的生产力革命已来</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/">技术笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/" rel="tag">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E6%8B%89%E5%8F%96/" rel="tag">代码拉取</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E7%AB%A0%EF%BC%8C%E5%8D%9A%E5%AE%A2%E6%A1%86%E6%9E%B6%EF%BC%8C%E6%8A%80%E6%9C%AF/" rel="tag">文章，博客框架，技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E6%B8%B8%E6%88%8F/" rel="tag">服务器，游戏</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE/" rel="tag">权限配置</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" rel="tag">编程语言</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E6%8B%89%E5%8F%96/" style="font-size: 10px;">代码拉取</a> <a href="/tags/%E6%96%87%E7%AB%A0%EF%BC%8C%E5%8D%9A%E5%AE%A2%E6%A1%86%E6%9E%B6%EF%BC%8C%E6%8A%80%E6%9C%AF/" style="font-size: 10px;">文章，博客框架，技术</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E6%B8%B8%E6%88%8F/" style="font-size: 10px;">服务器，游戏</a> <a href="/tags/%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">权限配置</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" style="font-size: 10px;">编程语言</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/12/">十二月 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/12/24/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83/">大模型微调</a>
          </li>
        
          <li>
            <a href="/2025/12/24/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8A%80%E6%9C%AF%E9%87%8C%E9%9D%A2%E7%9A%84%E2%80%98mcp%E2%80%99%E6%8A%80%E6%9C%AF/">计算机技术里面的‘mcp’技术</a>
          </li>
        
          <li>
            <a href="/2025/12/24/2025-8-19/">2025-8-19</a>
          </li>
        
          <li>
            <a href="/2025/12/24/%E9%82%A3%E4%BA%9B%E5%9C%A8%E5%85%AC%E5%8F%B8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84-%E8%B6%85%E7%BA%A7%E9%BB%84%E9%87%91-bug-%EF%BC%9A%E6%AF%8F%E4%B8%AA%E7%A8%8B%E5%BA%8F%E5%91%98%E9%83%BD%E8%AF%A5%E8%AE%B0%E5%8F%96%E7%9A%84%E8%A1%80%E6%B3%AA%E7%BB%8F%E9%AA%8C/">那些在公司工作中遇到的 &#39;超级黄金 bug&#39;：每个程序员都该记取的血泪经验</a>
          </li>
        
          <li>
            <a href="/2025/12/23/Java%E5%92%8Cgo%E8%AF%AD%E8%A8%80%E7%9A%842025%E5%B9%B4%E5%8F%91%E5%B1%95%E5%89%8D%E6%99%AF%E5%92%8C%E5%B0%B1%E4%B8%9A%E5%BD%A2%E5%8A%BF/">Java和go语言的2025年发展前景和就业形势</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 little chen<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>